!function($){"use strict";function initialize_map(e){var a=new google.maps.InfoWindow({maxWidth:315}),t=$(e).data("map-id"),r=gmb_data[t],o=r.map_params.latitude?r.map_params.latitude:"32.713240",n=r.map_params.longitude?r.map_params.longitude:"-117.159443",s={center:new google.maps.LatLng(o,n),zoom:parseInt(r.map_params.zoom),styles:[{stylers:[{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]}]};map=new google.maps.Map(e[0],s),places_service=new google.maps.places.PlacesService(map),set_map_options(map,r),set_map_theme(map,r),set_map_markers(map,r,a),"yes"===r.places_api.show_places&&perform_places_search(map,r,a)}function set_map_theme(map,map_data){var map_type=map_data.map_theme.map_type.toUpperCase(),map_theme=map_data.map_theme.map_theme_json;map.setOptions("ROADMAP"===map_type&&"none"!==map_theme?{mapTypeId:google.maps.MapTypeId.ROADMAP,styles:eval(map_theme)}:{mapTypeId:google.maps.MapTypeId[map_type],styles:!1})}function set_map_options(e,a){var t=a.map_controls.zoom_control;e.setOptions("none"===t?{zoomControl:!1}:{zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle[t]}});var r=a.map_controls.wheel_zoom;e.setOptions("none"===r?{scrollwheel:!1}:{scrollwheel:!0});var o=a.map_controls.pan_control;e.setOptions("none"===o?{panControl:!1}:{panControl:!0});var n=a.map_controls.street_view.toUpperCase();e.setOptions("NONE"===n?{streetViewControl:!1}:{streetViewControl:!0});var s=a.map_controls.double_click_zoom;e.setOptions("none"===s?{disableDoubleClickZoom:!0}:{disableDoubleClickZoom:!1});var i=a.map_controls.draggable;e.setOptions("none"===i?{draggable:!1}:{draggable:!0})}function set_map_markers(map,map_data,info_window){var map_markers=map_data.map_markers;$(map_markers).each(function(index,marker_data){var marker_icon=map_data.map_params.default_marker;"undefined"!=typeof marker_data.marker&&marker_data.marker.length>0&&(marker_icon=eval("("+marker_data.marker+")"));var marker_label="";"undefined"!=typeof marker_data.label&&marker_data.label.length>0&&(marker_label=marker_data.label);var location_marker=new Marker({map:map,zIndex:9,icon:marker_icon,label:marker_label}),marker_lat=marker_data.lat,marker_lng=marker_data.lng;location_marker.setPosition(new google.maps.LatLng(marker_lat,marker_lng)),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){info_window.close(),info_window.setContent('<div id="infobubble-content" class="loading"></div>'),set_info_window_content(marker_data,info_window),info_window.open(map,location_marker)})})}function set_info_window_content(e,a){var t;if(e.title&&(t='<p class="place-title">'+e.title+"</p>"),e.description&&(t+='<div class="place-description">'+e.description+"</div>"),e.reference){var r={reference:e.reference};places_service.getDetails(r,function(e,r){r==google.maps.places.PlacesServiceStatus.OK&&(t+=set_place_content_in_info_window(e),t=set_info_window_wrapper(t),a.setContent(t))})}else t=set_info_window_wrapper(t),a.setContent(t)}function set_place_content_in_info_window(e){var a;return a='<div class="marker-info-wrapper">',a+=e.formatted_address?'<div class="place-address">'+e.formatted_address+"</div>":"",a+=e.formatted_phone_number?'<div class="place-phone">'+e.formatted_phone_number+"</div>":"",a+=e.website?'<div class="place-website"><a href="'+e.website+'" target="_blank" rel="nofollow" title="Click to visit the '+e.name+' website">Website</a></div>':"",e.rating&&(a+='<div class="rating-wrap clear"><p class="numeric-rating">'+e.rating+'</p><div class="star-rating-wrap"><div class="star-rating-size" style="width:'+65*e.rating/5+'px;"></div></div></div>'),a+="</div>"}function set_info_window_wrapper(e){var a='<div id="infobubble-content" class="main-place-infobubble-content">';return a+=e,a+="</div>"}function perform_places_search(e,a,t){for(var r=e.getCenter(),o=a.places_api.search_places,n=0;n<search_markers.length;n++)search_markers[n].setMap(null);if(search_markers=[],o.length>0){var s={location:new google.maps.LatLng(r.lat(),r.lng()),types:o,radius:a.places_api.search_radius};places_service.nearbySearch(s,function(a,r,o){var n,s=0;if(r==google.maps.places.PlacesServiceStatus.OK){for(s=0;n=a[s];s++)create_search_result_marker(e,a[s],t);o.hasNextPage&&o.nextPage()}})}}function create_search_result_marker(e,a,t){var r=new google.maps.Marker({map:e});r.setIcon({url:a.icon,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(24,24)}),r.setPosition(a.geometry.location),r.setVisible(!0),google.maps.event.addListener(r,"click",function(){t.close(),t.setContent('<div id="infobubble-content" class="loading"></div>');var o={title:a.name,reference:a.reference};set_info_window_content(o,t),t.open(e,r)}),search_markers.push(r)}var map,places_service,place,location_marker_array=[],search_markers=[];$(function(){var e=$(".google-maps-builder");e.each(function(a,t){initialize_map($(e[a]))})})}(jQuery);