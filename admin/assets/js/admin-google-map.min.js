!function($){"use strict";function drop_marker(e,a){var t=e.lat(),o=e.lng();"undefined"!=typeof n&&n.setVisible(!1),$(".drop-marker").removeClass("active").text("Drop a Marker"),map.setOptions({draggableCursor:null}),google.maps.event.removeListener(a);var n=new Marker({position:e,map:map,icon:gmb_data.default_marker,zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),i=get_marker_index();$("#gmb_markers_group_"+i+"_title").val("Point "+i),$("#gmb_markers_group_"+i+"_lat").val(t),$("#gmb_markers_group_"+i+"_lng").val(o),get_editable_info_window(i,n),google.maps.event.addListener(n,"click",function(){get_info_window_content(i,n)})}function initialize_map(e){lat_field=$("#gmb_lat_lng-latitude"),lng_field=$("#gmb_lat_lng-longitude");var a=lat_field.val()?lat_field.val():"",t=lng_field.val()?lng_field.val():"";zoom=parseInt($("#gmb_zoom").val()),lat_lng=new google.maps.LatLng(a,t);var o={zoom:zoom,streetViewControl:!1,styles:[{stylers:[{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]}]};map=new google.maps.Map(e[0],o),places_service=new google.maps.places.PlacesService(map),navigator.geolocation&&"yes"===gmb_data.geolocate_setting&&""==t&&""==a?navigator.geolocation.getCurrentPosition(function(e){initial_location=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),map.setCenter(initial_location),lat_field.val(e.coords.latitude),lng_field.val(e.coords.longitude)}):""!==a&&""!==t?map.setCenter(new google.maps.LatLng(a,t)):(alert("Geolocation service failed."),initial_location=new google.maps.LatLng(gmb_data.default_lat,gmb_data.default_lng),lat_field.val(gmb_data.default_lat),lng_field.val(gmb_data.default_lng),map.setCenter(initial_location)),set_map_type(!1),"none"!==$("#gmb_theme").val()&&set_map_theme(!1),set_street_view(),set_pan_control(),set_draggable(),set_double_click_zoom(),set_mouse_wheel_scroll(),set_map_type_control(),set_map_zoom_control(),"undefined"==typeof autocomplete&&(autocomplete=new google.maps.places.Autocomplete($("#gmb_geocoder")[0]),autocomplete.bindTo("bounds",map),google.maps.event.addListener(autocomplete,"place_changed",function(){return $("#gmb_geocoder").one("blur",function(){$("#gmb_geocoder").val("")}),setTimeout(function(){$("#gmb_geocoder").val("")},10),"undefined"!=typeof tentative_location_marker&&tentative_location_marker.setVisible(!1),place=autocomplete.getPlace(),lat_field.val(place.geometry.location.lat()),lng_field.val(place.geometry.location.lng()),place.geometry?(map.setCenter(place.geometry.location),void add_tentative_marker(map,place.place_id)):void alert("Error: Place not found!")})),info_bubble=new google.maps.InfoWindow({maxWidth:315}),google.maps.event.addListenerOnce(map,"idle",function(){handle_map_zoom(map),add_markers(map),"undefined"!=typeof $(".cmb2-id-gmb-show-places input:radio").prop("checked")&&"yes"===$(".cmb2-id-gmb-show-places input:radio:checked").val()&&perform_places_search()}),google.maps.event.addListener(map,"zoom_changed",function(){handle_map_zoom(map)}),google.maps.event.addListener(map,"dragend",function(){var e=map.getCenter();$(".lat-lng-change-message").slideDown(),$(".lat-lng-update-btn").attr("data-lat",e.lat()),$(".lat-lng-update-btn").attr("data-lng",e.lng())})}function add_tentative_marker(e,a){var t=e.getCenter();tentative_location_marker=new google.maps.Marker({map:e,title:"Map Icons",animation:google.maps.Animation.DROP,position:new google.maps.LatLng(t.lat(),t.lng()),icon:new google.maps.MarkerImage(gmb_data.plugin_url+"/public/assets/img/temp-marker.png"),zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});var o=google.maps.event.addListener(tentative_location_marker,"mouseover",function(e){add_circle(a)}),n=google.maps.event.addListener(tentative_location_marker,"mouseout",function(e){hover_circle.setVisible(!1)});google.maps.event.addListener(tentative_location_marker,"click",function(){google.maps.event.removeListener(o),google.maps.event.removeListener(n),hover_circle.setVisible(!0),add_tenative_info_window(a,tentative_location_marker)}),tentative_location_marker.setVisible(!0),e.setZoom(zoom)}function add_tenative_info_window(e,a){var t={key:gmb_data.api_key,placeId:e};places_service.getDetails(t,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){var o=e.geometry.location.lat(),n=e.geometry.location.lng(),i='<p class="place-title">'+e.name+"</p>";i+=add_place_content_to_info_window(e),i+='<div class="infowindow-toolbar clear"><a href="#" class="add-marker" data-title="'+e.name+'" data-reference="'+e.place_id+'"  data-lat="'+o+'" data-lng="'+n+'">Add to Map</a></div>',i=set_info_window_wrapper(i),info_bubble.setContent(i),info_bubble.open(map,a),google.maps.event.addListener(info_bubble,"closeclick",function(){hover_circle.setVisible(!1)})}})}function add_place_content_to_info_window(e){var a;return a='<div class="marker-info-wrapper">',a+=e.formatted_address?'<div class="place-address">'+e.formatted_address+"</div>":"",a+=e.formatted_phone_number?'<div class="place-phone">'+e.formatted_phone_number+"</div>":"",a+=e.website?'<div class="place-website"><a href="'+e.website+'" target="_blank" rel="nofollow" title="Click to visit the '+e.name+' website">Website</a></div>':"",e.rating&&(a+='<div class="rating-wrap clear"><p class="numeric-rating">'+e.rating+'</p><div class="star-rating-wrap"><div class="star-rating-size" style="width:'+65*e.rating/5+'px;"></div></div></div>'),a+="</div>"}function get_editable_info_window(index,marker){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,marker);var info_window_data=get_info_window_saved_data(index),info_window_content;info_window_data.title||(info_window_data.title="Point "+index),info_window_data.title&&(info_window_content='<input class="edit-place-title" data-field="#gmb_markers_group_'+index+'_title" type="text" value="'+info_window_data.title+'">'),info_window_content+=info_window_data.desc?'<textarea class="edit-place-description" data-field="#gmb_markers_group_'+index+'_description">'+info_window_data.desc+"</textarea>":'<textarea class="edit-place-description" data-field="#gmb_markers_group_'+index+'_description" placeholder="Point Description"></textarea>',info_window_content+='<div class="infowindow-toolbar clear"><ul id="save-toolbar"><li class="info-window-save"><div class="google-btn-blue google-btn google-save-btn" data-tooltip="Save changes" data-index="'+index+'">Save</div></li><li class="info-window-cancel"><div class="google-btn-default google-btn google-cancel-btn" data-tooltip="Cancel edit" data-index="'+index+'">Cancel</div></li></ul><span class="marker-edit-link-wrap" data-index="'+index+'"><a href="#TB_inline?width=600&height=550&inlineId=marker-icon-modal" data-tooltip="Change icon" class="marker-edit-link thickbox"></a></span></div>',info_window_content=set_info_window_wrapper(info_window_content),info_bubble.setContent(info_window_content),initialize_tooltips(),google.maps.event.addDomListener($(".google-save-btn")[0],"click",function(){var e=$(".edit-place-title").data("field"),a=$(".edit-place-title").val(),t=$(".edit-place-description").data("field"),o=$(".edit-place-description").val();$(e).val(a),$(t).val(o),get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),google.maps.event.addDomListener(info_bubble,"closeclick",function(){google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),google.maps.event.addDomListener($(".google-cancel-btn")[0],"click",function(){get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)});var edit_marker_icon_button_click=google.maps.event.addDomListener($(".marker-edit-link-wrap")[0],"click",function(){$(".save-marker-button").attr("data-marker-index",$(this).data("index"))}),save_icon_listener=google.maps.event.addDomListener($(".save-marker-button")[0],"click",function(){var marker_position=marker.getPosition(),marker_icon_data,marker_icon=$(this).data("marker"),marker_icon_color=$(this).data("marker-color"),label_color=$(this).data("label-color"),marker_label_inline_style="color:"+label_color+"; ";"MAP_PIN"===marker_icon?marker_label_inline_style+="font-size: 20px;position: relative; top: -3px;":"SQUARE_PIN"==marker_icon&&(marker_label_inline_style+="font-size: 20px;position: relative; top: 12px;");var marker_label_data='<i class="'+$(this).data("label")+'" style="'+marker_label_inline_style+'"></i>';""==marker_icon?(marker_icon_data=gmb_data.plugin_url+"/public/assets/img/default-marker.png",$("#gmb_markers_group_"+index+"_marker").val(""),marker_label_data=""):(marker_icon_data="{ path : "+marker_icon+', fillColor : "'+marker_icon_color+'", fillOpacity : 1, strokeColor : "", strokeWeight: 0, scale : 1 / 3 }',$("#gmb_markers_group_"+index+"_marker").val(marker_icon_data),marker_icon_data=eval("("+marker_icon_data+")")),marker.setMap(null),$("#gmb_markers_group_"+index+"_label").val(marker_label_data),marker=new Marker({position:marker_position,map:map,zIndex:9,icon:marker_icon_data,label:marker_label_data}),google.maps.event.addListener(marker,"click",function(){get_info_window_content(index,marker)}),$(".icon, .marker-item").removeClass("marker-item-selected"),$(".marker-icon-row, .save-marker-icon, .marker-icon-color-wrap, .marker-label-color-wrap").hide(),$(this).removeData("marker"),$(this).removeData("marker-color"),$(this).removeData("label"),$(this).removeData("label-color"),tb_remove(),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)})}function set_info_window_wrapper(e){var a='<div id="infobubble-content" class="main-place-infobubble-content">';return a+=e,a+="</div>"}function add_circle(e){hover_circle=new google.maps.Marker({position:tentative_location_marker.getPosition(),zIndex:google.maps.Marker.MAX_ZINDEX-1,optimized:!1,icon:{path:google.maps.SymbolPath.CIRCLE,scale:20,strokeWeight:3,strokeOpacity:.9,strokeColor:"#FFF",fillOpacity:.3,fillColor:"#FFF"},map:map}),google.maps.event.addListener(hover_circle,"click",function(){add_tenative_info_window(e,tentative_location_marker)}),google.maps.event.addListener(tentative_location_marker,"click",function(){hover_circle.setVisible(!0)})}function add_markers(map){clear_main_markers(),$("#gmb_markers_group_repeat .cmb-repeatable-grouping").each(function(index){var marker_icon=gmb_data.plugin_url+"/public/assets/img/default-marker.png",marker_label="",custom_marker_icon=$("#gmb_markers_group_"+index+"_marker").val();custom_marker_icon.length>0&&(marker_icon=eval("("+custom_marker_icon+")"));var custom_label=$("#gmb_markers_group_"+index+"_label").val();custom_label.length>0&&(marker_label=custom_label);var location_marker=new Marker({map:map,zIndex:9,icon:marker_icon,label:marker_label}),marker_lat=$("#gmb_markers_group_"+index+"_lat").val(),marker_lng=$("#gmb_markers_group_"+index+"_lng").val();location_marker.setPosition(new google.maps.LatLng(marker_lat,marker_lng)),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){get_info_window_content(index,location_marker)})})}function get_info_window_saved_data(e){var a=new Object;return a.title=$("#gmb_markers_group_"+e+"_title").val(),a.desc=$("#gmb_markers_group_"+e+"_description").val(),a.reference=$("#gmb_markers_group_"+e+"_reference").val(),a.lat=$("#gmb_markers_group_"+e+"_lat").val(),a.lng=$("#gmb_markers_group_"+e+"_lng").val(),a}function get_info_window_content(e,a){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,a);var t,o=get_info_window_saved_data(e);if(o.reference){var n={placeId:o.reference};places_service.getDetails(n,function(n,i){i==google.maps.places.PlacesServiceStatus.OK&&(t='<p class="place-title">'+o.title+"</p>",t+='<div class="place-description">'+o.desc+"</div>",t+=add_place_content_to_info_window(n),t+='<div class="infowindow-toolbar"><ul id="edit-toolbar"><li class="edit-info" data-index="'+e+'" data-tooltip="Edit Marker"></li><li class="trash-marker" data-index="'+e+'" data-tooltip="Delete Marker"></li></ul></div>',add_edit_events(t,a))})}else t='<p class="place-title">'+o.title+"</p>",t+='<div class="place-description">'+o.desc+"</div>",t+='<div class="infowindow-toolbar"><ul id="edit-toolbar"><li class="edit-info" data-index="'+e+'" data-tooltip="Edit Marker"></li><li class="trash-marker" data-index="'+e+'" data-tooltip="Delete Marker"></li></ul></div>',add_edit_events(t,a)}function add_edit_events(e,a){e=set_info_window_wrapper(e),info_bubble.setContent(e),initialize_tooltips(),google.maps.event.addDomListener($(".edit-info")[0],"click",function(){get_editable_info_window($(this).data("index"),a)}),google.maps.event.addDomListener($(".trash-marker")[0],"click",function(){var e=$(this).data("index");0===e&&$('div[data-iterator="'+e+'"] ').find("input,textarea").val(""),$('div[data-iterator="'+e+'"] .remove-group-row').trigger("click"),info_bubble.close(),a.setVisible(!1)})}function get_marker_index(){var e=parseInt($("#gmb_markers_group_repeat div.cmb-repeatable-grouping").last().attr("data-iterator")),a=$('div[data-iterator="0"] ').find("input,textarea").val();return a&&0===e?($(".cmb-add-group-row.button").trigger("click"),e=1):0!==e&&($(".cmb-add-group-row.button").trigger("click"),e=parseInt($("#gmb_markers_group_repeat div.cmb-repeatable-grouping").last().attr("data-iterator"))),e}function get_place_info_window_content(e,a){info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,a);var t={placeId:e.reference};places_service.getDetails(t,function(e,a){if(a==google.maps.places.PlacesServiceStatus.OK){var t;t='<p class="place-title">'+e.name+"</p>",t+=add_place_content_to_info_window(e),t=set_info_window_wrapper(t),info_bubble.setContent(t),initialize_tooltips()}})}function get_places_type_array(){var e=[];return $('.cmb2-id-gmb-places-search-multicheckbox input[type="checkbox"]').each(function(){$(this).is(":checked")&&e.push($(this).val())}),e}function perform_places_search(){$(".places-loading").fadeIn(),$(".warning-message").hide().empty();var e=get_places_type_array();if(clear_search_markers(),e.length>0){var a={location:return_lat_lng(),types:e,radius:parseInt($("#gmb_search_radius").val())};places_service.nearbySearch(a,places_search_callback)}else show_warning_message("<strong>Notice: No Place Types are selected</strong><br/> Please select the types of places you would like to display on this map using the Place Type field checkboxes found below.")}function show_warning_message(e){$(".wpgp-loading").fadeOut(),$(".warning-message").empty().append("<p>"+e+"</p>").fadeIn()}function return_lat_lng(){var e=map.getCenter(),a=new google.maps.LatLng(e.lat(),e.lng());return a}function handle_map_zoom(e){var a=e.getZoom();$("#gmb_zoom").val(a),$("#gmb_zoom").on("change",function(){e.setZoom(parseInt($(this).val()))})}function lat_lng_field_change(e){var a=new google.maps.LatLng($(lat_field).val(),$(lng_field).val());e.panTo(a)}function places_search_callback(e,a,t){var o,n=0;if(a==google.maps.places.PlacesServiceStatus.OK){for(n=0;o=e[n];n++)create_search_result_marker(e[n]);t.hasNextPage?t.nextPage():$(".places-loading").fadeOut()}}function create_search_result_marker(e){var a=new Marker({map:map,zIndex:0,optimized:!1});a.setIcon({url:e.icon,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(24,24)}),a.setPosition(e.geometry.location),a.setVisible(!0),google.maps.event.addListener(a,"click",function(){get_place_info_window_content(e,a)}),search_markers.push(a)}function clear_main_markers(){for(var e=0;e<location_marker_array.length;e++)location_marker_array[e].setMap(null);for(location_marker_array.length=0,e=0;e<info_bubble_array.length;e++)info_bubble_array[e].close(),google.maps.event.trigger(info_bubble_array[e],"closeclick");info_bubble_array.length=0}function clear_search_markers(){for(var e=0;e<search_markers.length;e++)search_markers[e].setMap(null);search_markers=[]}function geocode_position(e){var a={location:e,radius:10};places_service.nearbySearch(a,function(e,a){if(a==google.maps.places.PlacesServiceStatus.OK){var t="";if(info_bubble.close(),e.length>1){t='<div id="infobubble-content"><p>Hmm, it looks like there are multiple places in this area. Please confirm which place you would like this marker to display:</p>';for(var o=0;o<e.length;o++)t+='<a class="marker-confirm-place"  data-reference="'+e[o].place_id+'" data-name-address="'+e[o].name+", "+e[o].vicinity+'">'+e[o].name+"</a>";t+="</div>",google.maps.event.addDomListener(info_bubble,"domready",function(){$(".marker-confirm-place").on("click",function(e){e.preventDefault(),$("#gmb_geocoder").val($(this).data("name-address")),$("#gmb_reference").val($(this).data("reference")),info_bubble.close(),get_info_window_content($(this).data("reference"))})})}info_bubble.setContent(t),info_bubble.open(map,location_marker)}})}function scroll_to_field(e){$("html, body").animate({scrollTop:parseInt($(e).offset().top)},600)}function marker_drag_end(e){var a=e.getPosition();geocode_position(a),$(lat_field).val(a.lat()),$(lng_field).val(a.lng()),map.panTo(a)}function calc_radius(e,a){radius_marker=new Marker({position:e.getCenter(),map:e,icon:{path:MAP_PIN,fillColor:"#0E77E9",fillOpacity:0,strokeColor:"",strokeWeight:0,scale:.25},label:'<i class="map-icon-crosshairs radius-label"></i>',zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),radius_circle=new google.maps.Circle({map:e,fillColor:"#BBD8E9",fillOpacity:.3,radius:a,strokeColor:"#BBD8E9",strokeOpacity:.9,strokeWeight:2}),radius_circle.bindTo("center",radius_marker,"position")}function toggle_metabox_fields(){var e=$(".cmb2-id-gmb-show-places input:radio");e.prop("checked")&&($(".cmb2-id-gmb-search-radius").toggle(),$(".cmb2-id-gmb-places-search-multicheckbox").toggle()),e.prop("checked")||$("#gmb_show_places2").prop("checked",!0),e.on("change",function(){$(".cmb2-id-gmb-search-radius").toggle(),$(".cmb2-id-gmb-places-search-multicheckbox").toggle(),"no"===$(this).val()?clear_search_markers():perform_places_search()})}function set_map_size(){var e=$("#gmb_width_height-width").val(),a=$('input[name="gmb_width_height[map_width_unit]"]:checked').val(),t=$("#gmb_width_height-height").val();$("#map").css({width:e+a,height:t})}function set_map_zoom_control(){var e=$("#gmb_zoom_control").val().toUpperCase();map.setOptions("NONE"==e?{zoomControl:!1}:{zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle[e]}})}function set_map_type_control(){var e=$("#gmb_map_type_control").val().toUpperCase();map.setOptions("NONE"==e?{mapTypeControl:!1}:{mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle[e]}})}function set_mouse_wheel_scroll(){var e=$("#gmb_wheel_zoom").val();map.setOptions("none"===e?{scrollwheel:!1}:{scrollwheel:!0})}function set_double_click_zoom(){var e=$("#gmb_double_click").val();map.setOptions("none"===e?{disableDoubleClickZoom:!0}:{disableDoubleClickZoom:!1})}function set_draggable(){var e=$("#gmb_draggable").val();map.setOptions("none"==e?{draggable:!1}:{draggable:!0})}function set_pan_control(){var e=$("#gmb_pan").val();map.setOptions("none"===e?{panControl:!1}:{panControl:!0})}function set_street_view(){var e=$("#gmb_street_view").val();map.setOptions("none"===e?{streetViewControl:!1}:{streetViewControl:!0})}function set_map_type(e){e===!0&&($("#gmb_theme").val("none"),$("#gmb_theme_json").val("none"));var a=$("#gmb_type").val().toUpperCase();map.setOptions({mapTypeId:google.maps.MapTypeId[a],styles:!1})}function set_map_theme(reset){reset===!0&&($("#gmb_type").val("RoadMap"),$("#gmb_theme_json").val("none"),$(".cmb2-id-gmb-theme-json").hide()),$.getJSON(gmb_data.snazzy,function(data){var map_theme_input_val=parseInt($("#gmb_theme").val());"none"===$("#gmb_theme").val()?(set_map_type(),$(".cmb2-id-gmb-theme-json").hide()):$(".cmb2-id-gmb-theme-json").show(),$.each(data,function(index){data[index].id===map_theme_input_val&&(map_theme_input_val=eval(data[index].json),$("#gmb_theme_json").val(data[index].json))}),map.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,styles:map_theme_input_val})})}function set_map_marker_icon(){$(".marker-item").on("click",function(){var e=$(this).data("marker");$(".marker-item").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),"default"==e?($(".marker-icon-row, .marker-icon-color-wrap, .marker-label-color-wrap").slideUp(),$(".save-marker-icon").slideDown(),$("#TB_window .save-marker-button").attr("data-marker",""),$("#TB_window .save-marker-button").attr("data-label","")):($(".marker-icon-color-wrap, .marker-icon-row").slideDown(),$("#TB_window .save-marker-button").attr("data-marker",e))}),$(".icon").on("click",function(){$(".icon").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),$(".save-marker-icon, .marker-label-color-wrap").slideDown(),$("#TB_window .save-marker-button").attr("data-label",$(this).find("span").attr("class"))});var e={change:function(e,a){var t=a.color.toString();$(this).hasClass("marker-color")===!0?($(".save-marker-button").attr("data-marker-color",t),$(".marker-svg polygon, .marker-svg path").attr("fill",t)):$(this).hasClass("label-color")===!0&&($(".save-marker-button").attr("data-label-color",t),$(".icon-inner span").css("color",t))},clear:function(){},hide:!0,palettes:!0};$(".color-picker").wpColorPicker(e)}function initialize_tooltips(){$('[data-tooltip!=""]').qtip({content:{attr:"data-tooltip"},hide:{fixed:!0,delay:100},position:{my:"top center",at:"bottom center"},style:{classes:"qtip-tipsy"},show:{when:{event:"focus"},effect:function(){$(this).fadeIn(200)}}})}$(window).load(function(){toggle_metabox_fields(),initialize_tooltips(),initialize_map($("#map")),$("#gmb_lat_lng-latitude").on("change",function(){lat_lng_field_change(map)}),$("#gmb_lat_lng-longitude").on("change",function(){lat_lng_field_change(map)}),$(".drop-marker").on("click",function(e){if(e.preventDefault(),$(this).hasClass("active"))$(this).text("Drop a Marker").removeClass("active"),map.setOptions({draggableCursor:null});else{$(this).text("Click on the Map").addClass("active"),map.setOptions({draggableCursor:"crosshair"});var a=google.maps.event.addListener(map,"click",function(e){drop_marker(e.latLng,a)})}});var e;$("#gmb_search_radius").on("focus",function(){e=$(this).val(),calc_radius(map,parseInt($(this).val()))}).focusout(function(){e!==$(this).val()&&perform_places_search(),radius_circle.setMap(null),radius_marker.setMap(null)}),$('[name^="gmb_places_search_multicheckbox"]').on("change",function(){0===$(".places-change-message").length&&($(".cmb2-id-gmb-places-search-multicheckbox ul").prepend('<div class="wpgp-message places-change-message clear"><p>Place selections have changed.</p><a href="#" class="button update-places-map">Update Map</a></div>'),$(".places-change-message").slideDown())}),$(".cmb-multicheck-toggle").on("click",function(){0===$(".places-change-message").length&&($(".cmb2-id-gmb-places-search-multicheckbox ul").prepend('<div class="wpgp-message places-change-message clear"><p>Place selections have changed.</p><a href="#" class="button update-places-map">Update Map</a></div>'),$(".places-change-message").slideDown())}),$(document).on("click",".update-places-map",function(e){e.preventDefault(),scroll_to_field("#google_maps_preview_metabox"),perform_places_search(),$(this).parent().fadeOut(function(){$(this).remove()})}),$(".lat-lng-update-btn").on("click",function(e){e.preventDefault(),$(".lat-lng-change-message").slideUp(),$("#gmb_lat_lng-latitude").val($(this).attr("data-lat")),$("#gmb_lat_lng-longitude").val($(this).attr("data-lng"))}),$(document).on("click",".add-marker",function(e){e.preventDefault(),hover_circle.setVisible(!1);var a=new google.maps.Marker({position:tentative_location_marker.getPosition(),map:map,icon:gmb_data.default_marker,zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});tentative_location_marker.setVisible(!1);var t=get_marker_index(),o=$(this).data("reference");get_editable_info_window(t,a),$('input[data-field="#gmb_markers_group_'+t+'_title"]').val($(this).data("title")),$("input#gmb_markers_group_"+t+"_lat").val($(this).data("lat")),$("input#gmb_markers_group_"+t+"_lng").val($(this).data("lng")),$("input#gmb_markers_group_"+t+"_reference").val(o),google.maps.event.addListener(a,"click",function(){get_info_window_content(t,a)})}),set_map_marker_icon(),$("#gmb_type").change(function(){set_map_type(!0)}),$("#gmb_theme").change(function(){set_map_theme(!0)}),$("#gmb_street_view").change(function(){set_street_view()}),$("#gmb_pan").change(function(){set_pan_control()}),$("#gmb_draggable").change(function(){set_draggable()}),$("#gmb_double_click").change(function(){set_double_click_zoom()}),$("#gmb_wheel_zoom").change(function(){set_mouse_wheel_scroll()}),$("#gmb_map_type_control").change(function(){set_map_type_control()}),$("#gmb_zoom_control").change(function(){set_map_zoom_control()}),$("#gmb_width_height-width, #gmb_width_height-height").keyup(function(){delay(function(){set_map_size()},500)}),$('input[name="gmb_width_height[map_width_unit]"]').change(function(){set_map_size()})});var map,places_service,lat_lng,zoom,lat_field,lng_field,radius_circle,radius_marker,place,autocomplete,info_bubble,info_bubble_array=[],tentative_location_marker,location_marker,location_marker_array=[],search_markers=[],hover_circle,initial_location,delay=function(){var e=0;return function(a,t){clearTimeout(e),e=setTimeout(a,t)}}()}(jQuery);