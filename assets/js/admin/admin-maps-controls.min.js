/**
 *  Maps Directions
 *
 *  @description: Adds directions functionality to the maps builder
 *  @copyright: http://opensource.org/licenses/gpl-2.0.php GNU Public License
 *  @since: 2.0
 */
var gmb_data,gmb_upload_marker,trafficLayer=new google.maps.TrafficLayer,transitLayer=new google.maps.TransitLayer,bicycleLayer=new google.maps.BicyclingLayer,placeSearchAutocomplete;!function(e){"use strict";/**
	 * Goto Location Autocomplete
	 *
	 */
function t(){var t=e(".map-autocomplete-wrap"),n=e("#map-location-autocomplete").get(0),o=new google.maps.places.Autocomplete(n);o.bindTo("bounds",map),google.maps.event.addListener(o,"place_changed",function(){var n=o.getPlace();
// If the place has a geometry, then present it on a map.
//Close modal
return n.geometry?(n.geometry.viewport?map.fitBounds(n.geometry.viewport):(map.setCenter(n.geometry.location),map.setZoom(17)),e(t).find(".mfp-close").trigger("click"),void a(t)):void window.alert("Autocomplete's returned place contains no geometry")}),
//Tame the enter key to not save the widget while using the autocomplete input
google.maps.event.addDomListener(n,"keydown",function(e){13==e.keyCode&&e.preventDefault()})}/**
	 * Close a Modal within Modal
	 *
	 * @param modal
	 */
function a(t){
// Move back out of container
e(t).addClass("mfp-hide").appendTo(".modal-placeholder").unwrap()}/**
	 * Edit Title within Modal
	 */
function n(){
//When edit title button is clicked insert title into feax input
e(".edit-title").on("click",function(){e("#modal_title").val(e("input#title").val())}),
//when feax title input is changed update default title field
e("#modal_title").on("blur",function(){e("input#title").val(e(this).val())})}/**
	 * Update Toolbar Lat/Lng
	 */
function o(){var t=e(".lat-lng-update-btn"),a=e(".update-lat-lng"),n=map.getCenter();e(".live-latitude").text(n.lat()),e(".live-longitude").text(n.lng()),a.attr("data-lat",n.lat()),e(".lat-lng-change-message").slideDown(),a.attr("data-lng",n.lng()),t.attr("data-lat",n.lat()),t.attr("data-lng",n.lng()),t.removeAttr("disabled"),a.removeAttr("disabled")}/**
	 * Kick it off on Window Load
	 */
e(window).on("load",function(){t(),n(),
//Set lng and lat when map dragging
google.maps.event.addListener(map,"drag",function(){o()}),
//Set lng and lat when map dragging
google.maps.event.addListener(map,"dragend",function(){o()}),
//Set lng and lat when map dragging
google.maps.event.addListener(map,"zoom_changed",function(){o()}),
//Initialize Magnific/Modal Functionality Too
e("body").on("click",".gmb-magnific-inline",function(t){t.preventDefault();var n="."+e(this).data("target");//target element class name
//Modal in modal?
//We can't have a magnific inside magnific so CSS3 modal it is
e.magnificPopup.instance.isOpen===!0?(
//Open CSS modal
e(n).before('<div class="modal-placeholder"></div>').removeClass("mfp-hide").appendTo(".magnific-builder #poststuff"),// Move the element to container
//Add close functionality to outside overlay
e(n).on("click",function(t){
//only on overlay
(e(t.target).hasClass("inner-modal-wrap")||e(t.target).hasClass("inner-modal-container"))&&
// Move back out of container
a(n)}),
//Close button
e(".gmb-modal-close").on("click",function(){a(n)})):e.magnificPopup.open({items:{src:e(n),type:"inline"},midClick:!0})})})}(jQuery);